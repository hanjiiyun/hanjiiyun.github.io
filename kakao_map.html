<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
  />
  <title>R2U Kakao Map</title>
  <style>
    html, body { margin:0; padding:0; height:100%; }
    #map { width:100%; height:100vh; }
  </style>
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=f3beaea643bdd2136019b366df1190cf"></script>
</head>
<body>
  <div id="map"></div>

  <script>
    // ğŸ”¹ ì „ì—­ ë³€ìˆ˜ (ë‹¤ë¥¸ í•¨ìˆ˜ì—ì„œë„ ì“¸ ìˆ˜ ìˆë„ë¡ varë¡œ ì„ ì–¸)
    var map;
    var routeLine = null;
    var startMarker = null;
    var endMarker = null;

    // ğŸ”¹ ì§€ë„ ìƒì„±
    (function initMap() {
      const container = document.getElementById('map');
      const options = {
        center: new kakao.maps.LatLng(37.4507, 126.6530), // ì¸í•˜ëŒ€ ê·¼ì²˜
        level: 3
      };
      map = new kakao.maps.Map(container, options);
    })();

    // ğŸ”¹ Flutterì—ì„œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜: ì¶”ì²œ ê²½ë¡œ í‘œì‹œ
    function showRecommendedRoute(routeData) {
  console.log("ğŸ“¡ ì¶”ì²œ ê²½ë¡œ ë°ì´í„°:", routeData);

  const linePath = [];

  // JSONì˜ polyline ë°°ì—´ì„ LatLng ë°°ì—´ë¡œ ë³€í™˜
  (routeData.polyline || []).forEach(function (p) {
    linePath.push(new kakao.maps.LatLng(p.lat, p.lng));
  });

  // ê¸°ì¡´ ê²½ë¡œê°€ ìˆìœ¼ë©´ ì œê±°
  if (routeLine) {
    routeLine.setMap(null);
  }

  // ğŸ”¹ ìƒˆ Polyline ìƒì„± (ì•± ë©”ì¸ ì»¬ëŸ¬: ì´ˆë¡)
  routeLine = new kakao.maps.Polyline({
    map: map,
    path: linePath,
    strokeWeight: 5,
    strokeColor: '#00C853', // âœ… ì´ˆë¡ìƒ‰ (ì›í•˜ë©´ ì½”ë“œ ë°”ê¿”ë„ ë¨)
    strokeOpacity: 0.9,
    strokeStyle: 'solid'
  });

  // ğŸ”¹ ì¶œë°œ/ë„ì°© ì¢Œí‘œ êµ¬í•˜ê¸°
  if (linePath.length > 0) {
    const startPos = linePath[0];
    const endPos = linePath[linePath.length - 1];

    // ì´ì „ ë§ˆì»¤ ìˆìœ¼ë©´ ì œê±°
    if (startMarker) startMarker.setMap(null);
    if (endMarker) endMarker.setMap(null);

    // ğŸ”¹ ì¶œë°œ ë§ˆì»¤
    startMarker = new kakao.maps.Marker({
      map: map,
      position: startPos
    });

    // ğŸ”¹ ë„ì°© ë§ˆì»¤ (ê¸°ë³¸ ë§ˆì»¤ + íƒ€ì´í‹€ë§Œ ë‹¤ë¥´ê²Œ)
    endMarker = new kakao.maps.Marker({
      map: map,
      position: endPos
    });

    // ğŸ”¹ ë§µ ì¤‘ì‹¬ì„ ì¶œë°œ ì§€ì ìœ¼ë¡œ ì´ë™
    map.setCenter(startPos);
  }
}

  </script>
</body>
</html>
